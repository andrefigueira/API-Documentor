/**
 * $ cFields 1.0
 * Developed by: André Figueira
 * Copyright (c) 2011 André Figueira
 *
 * This script is free software: you can redistribute it and/or modify it 
 * under the terms of the GNU General Public License as published by the Free 
 * Software Foundation, either version 3 of the License, or (at your option)
 * any later version.
 */ 
$.fn.cFields=function(options)
{var defaults={animation:'slide',speed:'fast',label:false}
var options=$.extend(defaults,options);var checked='';if($(this).is('select'))
{$(this).each(function(){var itemID=$(this).attr('id');if(options.label==true){var selected=$('#'+itemID+' option:selected').text();}else{var selected=$(this).val();}
var html='<a class="cField" id="fake'+itemID+'" href="javascript:{}"><span class="label">'+selected+'</span><span class="cFieldArrow"></span></a>';$(this).hide();$(this).after(html);});}
else if($(this).is('input[type=checkbox]'))
{$(this).each(function(){var itemID=$(this).attr('id');if($(this).is(':checked')){checked='cFieldCheckboxChecked';}else{checked='';}
var html='<a class="cFieldCheckbox '+checked+'" id="fake'+itemID+'" href="javascript:{}"></a>';$(this).after(html);$(this).hide();$('label[for='+itemID+']').attr('for','fake'+itemID);$('label[for=fake'+itemID+']').click(function(event){event.stopPropagation();$('#fake'+itemID).toggleClass('cFieldCheckboxChecked');if($('#'+itemID).is(':checked'))
{$('#'+itemID).removeAttr('checked');}
else
{$('#'+itemID).attr('checked','checked');}});});}
else if($(this).is('input[type=file]'))
{$(this).each(function(){var itemID=$(this).attr('id');var html='<a class="cFieldFile" id="fake'+itemID+'" href="javascript:{}">Browse</a><span class="fakeFileName" rel="fake'+itemID+'">No file selected</span>';$(this).after(html);$(this).hide();$('label[for='+itemID+']').attr('for','fake'+itemID+'');$('#fake'+itemID).click(function(event){event.stopPropagation();$('#'+itemID).click();$('#'+itemID).live('change',function(){var fileName=$(this).val().replace(/C:\\fakepath\\/i,'');$('.fakeFileName[rel=fake'+itemID+']').html(fileName);});});});}
$('.cField').click(function(event){var itemID=$(this).attr('id');itemID=itemID.replace("fake","");var items=1;event.stopPropagation();if($('.cFieldLists').size()>0){$('.cFieldLists').remove();}
if(items==1)
{var resultList='<ul style="position:absolute;" class="cFieldLists'+itemID+' cFieldLists">';$('#'+itemID+' > option').each(function(){var optionText=$(this).text();var optionValue=$(this).val();if(optionText!='')
{resultList=resultList+'<li optionID="'+optionValue+'" optionText="'+optionText+'">'+optionText+'</li>';}});resultList=resultList+'</ul>';$(this).after(resultList);var offset=$(this).offset();var itemleft=offset.left;$('.cFieldLists'+itemID).css({left:itemleft+"px"});var offset=$(this).offset();var itemleft=offset.left;$('.cFieldLists'+itemID).css({left:itemleft+"px"});if(options.animation=='slide'){$('.cFieldLists'+itemID).slideDown(options.speed);}else if(options.animation=='fade'){$('.cFieldLists'+itemID).fadeIn(options.speed);}
$('.cFieldLists'+itemID+' li').click(function(){if(options.animation=='slide')
{$('.cFieldLists'+itemID).slideUp(options.speed,function(){$('.cFieldLists').remove();});}
else if(options.animation=='fade')
{$('.cFieldLists'+itemID).fadeOut(options.speed,function(){$('.cFieldLists').remove();});}
var optionText=$(this).attr('optionText');$('#'+itemID+' option:selected').removeAttr('selected');$('#'+itemID+' option:contains(\''+optionText+'\')').attr('selected','selected');$('#'+itemID).trigger('change');$('#fake'+itemID+' .label').html(optionText);});$(document).ready(function(){$('body').click(function(){if(options.animation=='slide')
{$('.cFieldLists'+itemID).slideUp(options.speed,function(){$('.cFieldLists').remove();});}
else if(options.animation=='fade')
{$('.cFieldLists'+itemID).fadeOut(options.speed,function(){$('.cFieldLists').remove();});}});});}});}